{"version":3,"sources":["StaticGeometryColorBatch.ts"],"names":[],"mappings":"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","file":"StaticGeometryColorBatch.js","sourceRoot":"","sourcesContent":["/**\r\n * Fix for the constant entity shadowing.\r\n * PR in Cesium repo: https://github.com/AnalyticalGraphicsInc/cesium/pull/5736\r\n */\r\n\r\n// tslint:disable\r\nconst AssociativeArray = Cesium.AssociativeArray;\r\nconst Color = Cesium.Color;\r\nconst ColorGeometryInstanceAttribute = Cesium.ColorGeometryInstanceAttribute;\r\nconst defined = Cesium.defined;\r\nconst DistanceDisplayCondition = Cesium.DistanceDisplayCondition;\r\nconst DistanceDisplayConditionGeometryInstanceAttribute = Cesium.DistanceDisplayConditionGeometryInstanceAttribute;\r\nconst ShowGeometryInstanceAttribute = Cesium.ShowGeometryInstanceAttribute;\r\nconst Primitive = Cesium.Primitive;\r\nconst ShadowMode = Cesium.ShadowMode;\r\nconst BoundingSphereState = Cesium.BoundingSphereState;\r\nconst ColorMaterialProperty = Cesium.ColorMaterialProperty;\r\nconst MaterialProperty = Cesium.MaterialProperty;\r\nconst Property = Cesium.Property;\r\nconst colorScratch = new Color();\r\nconst  distanceDisplayConditionScratch = new DistanceDisplayCondition();\r\n\r\nfunction Batch(primitives: any, translucent: any, appearanceType: any, depthFailAppearanceType: any, depthFailMaterialProperty: any, closed: any, shadows: any) {\r\n  this.translucent = translucent;\r\n  this.appearanceType = appearanceType;\r\n  this.depthFailAppearanceType = depthFailAppearanceType;\r\n  this.depthFailMaterialProperty = depthFailMaterialProperty;\r\n  this.depthFailMaterial = undefined;\r\n  this.closed = closed;\r\n  this.shadows = shadows;\r\n  this.primitives = primitives;\r\n  this.createPrimitive = false;\r\n  this.waitingOnCreate = false;\r\n  this.primitive = undefined;\r\n  this.oldPrimitive = undefined;\r\n  this.geometry = new AssociativeArray();\r\n  this.updaters = new AssociativeArray();\r\n  this.updatersWithAttributes = new AssociativeArray();\r\n  this.attributes = new AssociativeArray();\r\n  this.subscriptions = new AssociativeArray();\r\n  this.showsUpdated = new AssociativeArray();\r\n  this.itemsToRemove = [];\r\n  this.invalidated = false;\r\n\r\n  var removeMaterialSubscription;\r\n  if (defined(depthFailMaterialProperty)) {\r\n    removeMaterialSubscription = depthFailMaterialProperty.definitionChanged.addEventListener(Batch.prototype.onMaterialChanged, this);\r\n  }\r\n  this.removeMaterialSubscription = removeMaterialSubscription;\r\n}\r\n\r\nBatch.prototype.onMaterialChanged = function() {\r\n  this.invalidated = true;\r\n};\r\n\r\nBatch.prototype.isMaterial = function(updater: any) {\r\n  var material = this.depthFailMaterialProperty;\r\n  var updaterMaterial = updater.depthFailMaterialProperty;\r\n  if (updaterMaterial === material) {\r\n    return true;\r\n  }\r\n  if (defined(material)) {\r\n    return material.equals(updaterMaterial);\r\n  }\r\n  return false;\r\n};\r\n\r\nBatch.prototype.add = function(updater: any, instance: any) {\r\n  var id = updater.entity.id;\r\n  this.createPrimitive = true;\r\n  this.geometry.set(id, instance);\r\n  this.updaters.set(id, updater);\r\n  if (!updater.hasConstantFill || !updater.fillMaterialProperty.isConstant || !Property.isConstant(updater.distanceDisplayConditionProperty)) {\r\n    this.updatersWithAttributes.set(id, updater);\r\n  } else {\r\n    var that = this;\r\n    this.subscriptions.set(id, updater.entity.definitionChanged.addEventListener(function(entity, propertyName, newValue, oldValue) {\r\n      if (propertyName === 'isShowing') {\r\n        that.showsUpdated.set(entity.id, updater);\r\n      }\r\n    }));\r\n  }\r\n};\r\n\r\nBatch.prototype.remove = function(updater: any) {\r\n  var id = updater.entity.id;\r\n  this.createPrimitive = this.geometry.remove(id) || this.createPrimitive;\r\n  if (this.updaters.remove(id)) {\r\n    this.updatersWithAttributes.remove(id);\r\n    var unsubscribe = this.subscriptions.get(id);\r\n    if (defined(unsubscribe)) {\r\n      unsubscribe();\r\n      this.subscriptions.remove(id);\r\n    }\r\n  }\r\n};\r\n\r\nBatch.prototype.update = function(time: any) {\r\n  var isUpdated = true;\r\n  var removedCount = 0;\r\n  var primitive = this.primitive;\r\n  var primitives = this.primitives;\r\n  var attributes;\r\n  var i;\r\n\r\n  if (this.createPrimitive) {\r\n    var geometries = this.geometry.values;\r\n    var geometriesLength = geometries.length;\r\n    if (geometriesLength > 0) {\r\n      if (defined(primitive)) {\r\n        if (!defined(this.oldPrimitive)) {\r\n          this.oldPrimitive = primitive;\r\n        } else {\r\n          primitives.remove(primitive);\r\n        }\r\n      }\r\n\r\n      for (i = 0; i < geometriesLength; i++) {\r\n        var geometryItem = geometries[i];\r\n        var originalAttributes = geometryItem.attributes;\r\n        attributes = this.attributes.get(geometryItem.id.id);\r\n\r\n        if (defined(attributes)) {\r\n          if (defined(originalAttributes.show)) {\r\n            originalAttributes.show.value = attributes.show;\r\n          }\r\n          if (defined(originalAttributes.color)) {\r\n            originalAttributes.color.value = attributes.color;\r\n          }\r\n          if (defined(originalAttributes.depthFailColor)) {\r\n            originalAttributes.depthFailColor.value = attributes.depthFailColor;\r\n          }\r\n        }\r\n      }\r\n\r\n      var depthFailAppearance;\r\n      if (defined(this.depthFailAppearanceType)) {\r\n        if (defined(this.depthFailMaterialProperty)) {\r\n          this.depthFailMaterial = MaterialProperty.getValue(time, this.depthFailMaterialProperty, this.depthFailMaterial);\r\n        }\r\n        depthFailAppearance = new this.depthFailAppearanceType({\r\n          material : this.depthFailMaterial,\r\n          translucent : this.translucent,\r\n          closed : this.closed\r\n        });\r\n      }\r\n\r\n      primitive = new Primitive({\r\n        asynchronous : true,\r\n        geometryInstances : geometries,\r\n        appearance : new this.appearanceType({\r\n          flat: this.shadows === ShadowMode.DISABLED || this.shadows === ShadowMode.CAST_ONLY,\r\n          translucent : this.translucent,\r\n          closed : this.closed\r\n        }),\r\n        depthFailAppearance : depthFailAppearance,\r\n        shadows : this.shadows\r\n      });\r\n      primitives.add(primitive);\r\n      isUpdated = false;\r\n    } else {\r\n      if (defined(primitive)) {\r\n        primitives.remove(primitive);\r\n        primitive = undefined;\r\n      }\r\n      var oldPrimitive = this.oldPrimitive;\r\n      if (defined(oldPrimitive)) {\r\n        primitives.remove(oldPrimitive);\r\n        this.oldPrimitive = undefined;\r\n      }\r\n    }\r\n\r\n    this.attributes.removeAll();\r\n    this.primitive = primitive;\r\n    this.createPrimitive = false;\r\n    this.waitingOnCreate = true;\r\n  } else if (defined(primitive) && primitive.ready) {\r\n    if (defined(this.oldPrimitive)) {\r\n      primitives.remove(this.oldPrimitive);\r\n      this.oldPrimitive = undefined;\r\n    }\r\n\r\n    if (defined(this.depthFailAppearanceType) && !(this.depthFailMaterialProperty instanceof ColorMaterialProperty)) {\r\n      this.depthFailMaterial = MaterialProperty.getValue(time, this.depthFailMaterialProperty, this.depthFailMaterial);\r\n      this.primitive.depthFailAppearance.material = this.depthFailMaterial;\r\n    }\r\n\r\n    var updatersWithAttributes = this.updatersWithAttributes.values;\r\n    var length = updatersWithAttributes.length;\r\n    var waitingOnCreate = this.waitingOnCreate;\r\n    for (i = 0; i < length; i++) {\r\n      var updater = updatersWithAttributes[i];\r\n      var instance = this.geometry.get(updater.entity.id);\r\n\r\n      attributes = this.attributes.get(instance.id.id);\r\n      if (!defined(attributes)) {\r\n        attributes = primitive.getGeometryInstanceAttributes(instance.id);\r\n        this.attributes.set(instance.id.id, attributes);\r\n      }\r\n\r\n      if (!updater.fillMaterialProperty.isConstant || waitingOnCreate) {\r\n        var colorProperty = updater.fillMaterialProperty.color;\r\n        colorProperty.getValue(time, colorScratch);\r\n        if (!Color.equals(attributes._lastColor, colorScratch)) {\r\n          attributes._lastColor = Color.clone(colorScratch, attributes._lastColor);\r\n          attributes.color = ColorGeometryInstanceAttribute.toValue(colorScratch, attributes.color);\r\n          if ((this.translucent && attributes.color[3] === 255) || (!this.translucent && attributes.color[3] !== 255)) {\r\n            this.itemsToRemove[removedCount++] = updater;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (defined(this.depthFailAppearanceType) && this.depthFailAppearanceType instanceof ColorMaterialProperty && (!updater.depthFailMaterialProperty.isConstant || waitingOnCreate)) {\r\n        var depthFailColorProperty = updater.depthFailMaterialProperty.color;\r\n        depthFailColorProperty.getValue(time, colorScratch);\r\n        if (!Color.equals(attributes._lastDepthFailColor, colorScratch)) {\r\n          attributes._lastDepthFailColor = Color.clone(colorScratch, attributes._lastDepthFailColor);\r\n          attributes.depthFailColor = ColorGeometryInstanceAttribute.toValue(colorScratch, attributes.depthFailColor);\r\n        }\r\n      }\r\n\r\n      var show = updater.entity.isShowing && (updater.hasConstantFill || updater.isFilled(time));\r\n      var currentShow = attributes.show[0] === 1;\r\n      if (show !== currentShow) {\r\n        attributes.show = ShowGeometryInstanceAttribute.toValue(show, attributes.show);\r\n      }\r\n\r\n      var distanceDisplayConditionProperty = updater.distanceDisplayConditionProperty;\r\n      if (!Property.isConstant(distanceDisplayConditionProperty)) {\r\n        var distanceDisplayCondition = distanceDisplayConditionProperty.getValue(time, distanceDisplayConditionScratch);\r\n        if (!DistanceDisplayCondition.equals(distanceDisplayCondition, attributes._lastDistanceDisplayCondition)) {\r\n          attributes._lastDistanceDisplayCondition = DistanceDisplayCondition.clone(distanceDisplayCondition, attributes._lastDistanceDisplayCondition);\r\n          attributes.distanceDisplayCondition = DistanceDisplayConditionGeometryInstanceAttribute.toValue(distanceDisplayCondition, attributes.distanceDisplayCondition);\r\n        }\r\n      }\r\n    }\r\n\r\n    this.updateShows(primitive);\r\n    this.waitingOnCreate = false;\r\n  } else if (defined(primitive) && !primitive.ready) {\r\n    isUpdated = false;\r\n  }\r\n  this.itemsToRemove.length = removedCount;\r\n  return isUpdated;\r\n};\r\n\r\nBatch.prototype.updateShows = function(primitive: any) {\r\n  var showsUpdated = this.showsUpdated.values;\r\n  var length = showsUpdated.length;\r\n  for (var i = 0; i < length; i++) {\r\n    var updater = showsUpdated[i];\r\n    var instance = this.geometry.get(updater.entity.id);\r\n\r\n    var attributes = this.attributes.get(instance.id.id);\r\n    if (!defined(attributes)) {\r\n      attributes = primitive.getGeometryInstanceAttributes(instance.id);\r\n      this.attributes.set(instance.id.id, attributes);\r\n    }\r\n\r\n    var show = updater.entity.isShowing;\r\n    var currentShow = attributes.show[0] === 1;\r\n    if (show !== currentShow) {\r\n      attributes.show = ShowGeometryInstanceAttribute.toValue(show, attributes.show);\r\n    }\r\n  }\r\n  this.showsUpdated.removeAll();\r\n};\r\n\r\nBatch.prototype.contains = function(entity: any) {\r\n  return this.updaters.contains(entity.id);\r\n};\r\n\r\nBatch.prototype.getBoundingSphere = function(entity: any, result: any) {\r\n  var primitive = this.primitive;\r\n  if (!primitive.ready) {\r\n    return BoundingSphereState.PENDING;\r\n  }\r\n  var attributes = primitive.getGeometryInstanceAttributes(entity);\r\n  if (!defined(attributes) || !defined(attributes.boundingSphere) ||//\r\n    (defined(attributes.show) && attributes.show[0] === 0)) {\r\n    return BoundingSphereState.FAILED;\r\n  }\r\n  attributes.boundingSphere.clone(result);\r\n  return BoundingSphereState.DONE;\r\n};\r\n\r\nBatch.prototype.removeAllPrimitives = function() {\r\n  var primitives = this.primitives;\r\n\r\n  var primitive = this.primitive;\r\n  if (defined(primitive)) {\r\n    primitives.remove(primitive);\r\n    this.primitive = undefined;\r\n    this.geometry.removeAll();\r\n    this.updaters.removeAll();\r\n  }\r\n\r\n  var oldPrimitive = this.oldPrimitive;\r\n  if (defined(oldPrimitive)) {\r\n    primitives.remove(oldPrimitive);\r\n    this.oldPrimitive = undefined;\r\n  }\r\n};\r\n\r\nBatch.prototype.destroy = function() {\r\n  var primitive = this.primitive;\r\n  var primitives = this.primitives;\r\n  if (defined(primitive)) {\r\n    primitives.remove(primitive);\r\n  }\r\n  var oldPrimitive = this.oldPrimitive;\r\n  if (defined(oldPrimitive)) {\r\n    primitives.remove(oldPrimitive);\r\n  }\r\n  if(defined(this.removeMaterialSubscription)) {\r\n    this.removeMaterialSubscription();\r\n  }\r\n};\r\n\r\nlet wasFixed = false;\r\nexport function fixCesiumEntitiesShadows() {\r\n  if(wasFixed){\r\n    return;\r\n  }\r\n  Cesium.StaticGeometryColorBatch.prototype.add = function (time: any, updater: any) {\r\n    var items;\r\n    var translucent;\r\n    var instance = updater.createFillGeometryInstance(time);\r\n    if (instance.attributes.color.value[3] === 255) {\r\n      items = this._solidItems;\r\n      translucent = false;\r\n    } else {\r\n      items = this._translucentItems;\r\n      translucent = true;\r\n    }\r\n\r\n    var length = items.length;\r\n    for (var i = 0; i < length; i++) {\r\n      var item = items[i];\r\n      if (item.isMaterial(updater)) {\r\n        item.add(updater, instance);\r\n        return;\r\n      }\r\n\r\n    }\r\n\r\n    var batch: any = new Batch(this._primitives, translucent, this._appearanceType, this._depthFailAppearanceType, updater.depthFailMaterialProperty, this._closed, this._shadows);\r\n    batch.add(updater, instance);\r\n    items.push(batch);\r\n  };\r\n  wasFixed = true;\r\n}"]}