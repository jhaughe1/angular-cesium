{"version":3,"sources":["ac-map.component.ts"],"names":[],"mappings":"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","file":"ac-map.component.js","sourceRoot":"","sourcesContent":["import { AfterViewInit, Component, ElementRef, Inject, Input, OnChanges, OnInit, SimpleChanges } from '@angular/core';\r\nimport { DOCUMENT } from '@angular/common';\r\nimport { CesiumService } from '../../services/cesium/cesium.service';\r\nimport { BillboardDrawerService } from '../../services/drawers/billboard-drawer/billboard-drawer.service';\r\nimport { MapEventsManagerService } from '../../services/map-events-mananger/map-events-manager';\r\nimport { CesiumEventBuilder } from '../../services/map-events-mananger/cesium-event-builder';\r\nimport { PlonterService } from '../../services/plonter/plonter.service';\r\nimport { LabelDrawerService } from '../../services/drawers/label-drawer/label-drawer.service';\r\nimport { PolylineDrawerService } from '../../services/drawers/polyline-drawer/polyline-drawer.service';\r\nimport { PointDrawerService } from '../../services/drawers/point-drawer/point-drawer.service';\r\nimport { ArcDrawerService } from '../../services/drawers/arc-drawer/arc-drawer.service';\r\nimport { MapsManagerService } from '../../services/maps-manager/maps-manager.service';\r\nimport { EllipseDrawerService } from '../../services/drawers/ellipse-drawer/ellipse-drawer.service';\r\nimport { PolygonDrawerService } from '../../services/drawers/polygon-drawer/polygon-drawer.service';\r\nimport { KeyboardControlService } from '../../services/keyboard-control/keyboard-control.service';\r\nimport { CameraService } from '../../services/camera/camera.service';\r\nimport { SceneMode } from '../../models/scene-mode.enum';\r\nimport { MapLayersService } from '../../services/map-layers/map-layers.service';\r\nimport { ConfigurationService } from '../../cesium-enhancements/ConfigurationService';\r\nimport { ScreenshotService } from '../../services/screenshot/screenshot.service';\r\nimport { ContextMenuService } from '../../services/context-menu/context-menu.service';\r\nimport { CoordinateConverter } from '../../services/coordinate-converter/coordinate-converter.service';\r\nimport {PolylinePrimitiveDrawerService} from '../../services/drawers/polyline-primitive-drawer/polyline-primitive-drawer.service'\r\n\r\n/**\r\n * This is a map implementation, creates the cesium map.\r\n * Every layer should be tag inside ac-map tag\r\n *\r\n * Accessing cesium viewer:\r\n * 1. acMapComponent.getCesiumViewer()\r\n * 2. Use MapManagerService.getMap().getCesiumViewer() or if more then one map: MapManagerService.getMap(mapId).getCesiumViewer()\r\n *\r\n *\r\n * @example\r\n * <ac-map>\r\n *     <ac-map-layer-provider></ac-map-layer-provider>\r\n *     <dynamic-ellipse-layer #layer></dynamic-ellipse-layer>\r\n * </ac-map>\r\n */\r\n\r\nexport class AcMapComponent implements OnChanges, OnInit, AfterViewInit {\r\n\r\n  /**\r\n   * Disable default plonter context menu\r\n   */\r\n  \r\n  disableDefaultPlonter = false;\r\n\r\n  /**\r\n   * Set the id name of the map\r\n   * default: 'default-map-id-[index]'\r\n   * @type {string}\r\n   */\r\n  \r\n  id: string;\r\n\r\n  /**\r\n   * flyTo options according to https://cesiumjs.org/Cesium/Build/Documentation/Camera.html?classFilter=cam#flyTo\r\n   */\r\n  \r\n  flyTo: any;\r\n\r\n  /**\r\n   * Sets the map's SceneMode\r\n   */\r\n  \r\n  sceneMode: SceneMode;\r\n\r\n  private mapContainer: HTMLElement;\r\n\r\n  constructor(private _cesiumService: CesiumService,\r\n              private _cameraService: CameraService,\r\n              private _elemRef: ElementRef,\r\n               private document: any,\r\n              private mapsManagerService: MapsManagerService,\r\n              private billboardDrawerService: BillboardDrawerService,\r\n              private labelDrawerService: LabelDrawerService,\r\n              private ellipseDrawerService: EllipseDrawerService,\r\n              private polylineDrawerService: PolylineDrawerService,\r\n              private polygonDrawerService: PolygonDrawerService,\r\n              private arcDrawerService: ArcDrawerService,\r\n              private pointDrawerService: PointDrawerService,\r\n              private mapEventsManager: MapEventsManagerService,\r\n              private keyboardControlService: KeyboardControlService,\r\n              private mapLayersService: MapLayersService,\r\n              private configurationService: ConfigurationService,\r\n              private screenshotService: ScreenshotService,\r\n              public contextMenuService: ContextMenuService,\r\n              private coordinateConverter: CoordinateConverter) {\r\n    this.mapContainer = this.document.createElement('div');\r\n    this.mapContainer.className = 'map-container';\r\n    this._elemRef.nativeElement.appendChild(this.mapContainer);\r\n    this._cesiumService.init(this.mapContainer);\r\n    this._cameraService.init(this._cesiumService);\r\n\t\tthis.mapEventsManager.init();\r\n\t\tthis.billboardDrawerService.init();\r\n\t\tthis.labelDrawerService.init();\r\n\t\tthis.ellipseDrawerService.init();\r\n\t\tthis.polylineDrawerService.init();\r\n\t\tthis.polygonDrawerService.init();\r\n\t\tthis.arcDrawerService.init();\r\n\t\tthis.pointDrawerService.init();\r\n\t\tthis.keyboardControlService.init();\r\n    this.contextMenuService.init(this.mapEventsManager);\r\n  }\r\n\r\n  ngOnInit() {\r\n    this.mapsManagerService.registerMap(this.id, this);\r\n  }\r\n\r\n  ngOnChanges(changes: SimpleChanges): void {\r\n    if (changes['sceneMode']) {\r\n      this._cameraService.setSceneMode(changes['sceneMode'].currentValue);\r\n    }\r\n    if (changes['flyTo']) {\r\n      this._cameraService.cameraFlyTo(changes['flyTo'].currentValue);\r\n    }\r\n  }\r\n\t\r\n\tngAfterViewInit(): void {\r\n    this.mapLayersService.drawAllLayers();\r\n\t}\r\n\r\n  /**\r\n   * @returns {CesiumService} ac-map's cesium service\r\n   */\r\n  getCesiumSerivce() {\r\n    return this._cesiumService;\r\n  }\r\n\r\n  /**\r\n   * @returns {Viewer} map's cesium viewer\r\n   */\r\n  getCesiumViewer() {\r\n    return this._cesiumService.getViewer();\r\n  }\r\n\r\n  /**\r\n   * @returns {CameraService} map's scene's camera\r\n   */\r\n  getCameraService(): CameraService {\r\n    return this._cameraService;\r\n  }\r\n\r\n  /**\r\n   * @returns {string} the map id\r\n   */\r\n  getId() {\r\n    return this.id;\r\n  }\r\n\r\n  /**\r\n   * @returns {MapEventsManagerService}\r\n   */\r\n  getMapEventsManager(): MapEventsManagerService {\r\n    return this.mapEventsManager;\r\n  }\r\n\r\n  /**\r\n   * @returns {ContextMenuService}\r\n   */\r\n  getContextMenuService(): ContextMenuService {\r\n    return this.contextMenuService;\r\n  }\r\n\r\n  getScreenshotService() {\r\n    return this.screenshotService;\r\n  }\r\n\r\n  /**\r\n   * @returns {KeyboardControlService}\r\n   */\r\n  getKeyboardControlService() {\r\n    return this.keyboardControlService;\r\n  }\r\n\r\n  /**\r\n   * @returns {CoordinateConverter}\r\n   */\r\n  getCoordinateConverter() {\r\n    return this.coordinateConverter\r\n  }\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\r\n  selector: 'ac-map',\r\n  template: `\r\n      <ac-default-plonter *ngIf=\"!disableDefaultPlonter\"></ac-default-plonter>\r\n      <ac-context-menu-wrapper></ac-context-menu-wrapper>\r\n      <ng-content></ng-content>`,\r\n  providers: [\r\n    CesiumService,\r\n    BillboardDrawerService,\r\n    CesiumEventBuilder,\r\n    KeyboardControlService,\r\n    MapEventsManagerService,\r\n    PlonterService,\r\n    LabelDrawerService,\r\n    PolylineDrawerService,\r\n    PolylinePrimitiveDrawerService,\r\n    EllipseDrawerService,\r\n    PointDrawerService,\r\n    ArcDrawerService,\r\n    PolygonDrawerService,\r\n    MapLayersService,\r\n    CameraService,\r\n\t\tScreenshotService,\r\n    ContextMenuService,\r\n    CoordinateConverter,\r\n  ]\r\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: CesiumService, },\n{type: CameraService, },\n{type: ElementRef, },\n{type: undefined, decorators: [{ type: Inject, args: [DOCUMENT, ] }, ]},\n{type: MapsManagerService, },\n{type: BillboardDrawerService, },\n{type: LabelDrawerService, },\n{type: EllipseDrawerService, },\n{type: PolylineDrawerService, },\n{type: PolygonDrawerService, },\n{type: ArcDrawerService, },\n{type: PointDrawerService, },\n{type: MapEventsManagerService, },\n{type: KeyboardControlService, },\n{type: MapLayersService, },\n{type: ConfigurationService, },\n{type: ScreenshotService, },\n{type: ContextMenuService, },\n{type: CoordinateConverter, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'disableDefaultPlonter': [{ type: Input },],\n'id': [{ type: Input },],\n'flyTo': [{ type: Input },],\n'sceneMode': [{ type: Input },],\n};\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}