{"version":3,"sources":["hippodrome-editor.component.ts"],"names":[],"mappings":"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","file":"hippodrome-editor.component.js","sourceRoot":"","sourcesContent":["import { Component, OnDestroy, ViewChild } from '@angular/core';\r\nimport { EditModes } from '../../models/edit-mode.enum';\r\nimport { AcNotification } from '../../../angular-cesium/models/ac-notification';\r\nimport { EditActions } from '../../models/edit-actions.enum';\r\nimport { AcLayerComponent } from '../../../angular-cesium/components/ac-layer/ac-layer.component';\r\nimport { CoordinateConverter } from '../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\r\nimport { MapEventsManagerService } from '../../../angular-cesium/services/map-events-mananger/map-events-manager';\r\nimport { Subject } from 'rxjs/Subject';\r\nimport { CameraService } from '../../../angular-cesium/services/camera/camera.service';\r\nimport { EditPoint } from '../../models/edit-point';\r\nimport { HippodromeManagerService } from '../../services/entity-editors/hippodrome-editor/hippodrome-manager.service';\r\nimport { HippodromeEditorService } from '../../services/entity-editors/hippodrome-editor/hippodrome-editor.service';\r\nimport { HippodromeEditUpdate } from '../../models/hippodrome-edit-update';\r\nimport { LabelProps } from '../../models/label-props';\r\nimport { EditableHippodrome } from '../../models/editable-hippodrome';\r\n\r\n\r\nexport class HippodromeEditorComponent implements OnDestroy {\r\n\r\n  private editLabelsRenderFn: (update: HippodromeEditUpdate, labels: LabelProps[]) => LabelProps[];\r\n  public Cesium = Cesium;\r\n  public editPoints$ = new Subject<AcNotification>();\r\n  public editHippodromes$ = new Subject<AcNotification>();\r\n\r\n   private editPointsLayer: AcLayerComponent;\r\n   private editHippodromesLayer: AcLayerComponent;\r\n\r\n  constructor(private hippodromesEditor: HippodromeEditorService,\r\n              private coordinateConverter: CoordinateConverter,\r\n              private mapEventsManager: MapEventsManagerService,\r\n              private cameraService: CameraService,\r\n              private hippodromesManager: HippodromeManagerService) {\r\n    this.hippodromesEditor.init(this.mapEventsManager, this.coordinateConverter, this.cameraService, hippodromesManager);\r\n    this.startListeningToEditorUpdates();\r\n  }\r\n\r\n  private startListeningToEditorUpdates() {\r\n    this.hippodromesEditor.onUpdate().subscribe((update: HippodromeEditUpdate) => {\r\n      if (update.editMode === EditModes.CREATE || update.editMode === EditModes.CREATE_OR_EDIT) {\r\n        this.handleCreateUpdates(update);\r\n      }\r\n      else if (update.editMode === EditModes.EDIT) {\r\n        this.handleEditUpdates(update);\r\n      }\r\n    });\r\n  }\r\n\r\n  getLabelId(element: any, index: number): string {\r\n    return index.toString();\r\n  }\r\n\r\n  renderEditLabels(hippodrome: EditableHippodrome, update: HippodromeEditUpdate, labels?: LabelProps[]) {\r\n    update.positions = hippodrome.getRealPositions();\r\n    update.points = hippodrome.getRealPoints();\r\n\r\n    if (labels) {\r\n      hippodrome.labels = labels;\r\n      this.editHippodromesLayer.update(hippodrome, hippodrome.getId());\r\n      return;\r\n    }\r\n\r\n    if (!this.editLabelsRenderFn) {\r\n      return;\r\n    }\r\n\r\n    hippodrome.labels = this.editLabelsRenderFn(update, hippodrome.labels);\r\n    this.editHippodromesLayer.update(hippodrome, hippodrome.getId());\r\n\r\n  }\r\n\r\n  removeEditLabels(hippodrome: EditableHippodrome) {\r\n    hippodrome.labels = [];\r\n    this.editHippodromesLayer.update(hippodrome, hippodrome.getId());\r\n  }\r\n\r\n  handleCreateUpdates(update: HippodromeEditUpdate) {\r\n    switch (update.editAction) {\r\n      case EditActions.INIT: {\r\n        this.hippodromesManager.createEditableHippodrome(\r\n          update.id,\r\n          this.editPointsLayer,\r\n          this.editHippodromesLayer,\r\n          this.coordinateConverter,\r\n          update.hippodromeOptions);\r\n        break;\r\n      }\r\n      case EditActions.MOUSE_MOVE: {\r\n        const hippodrome = this.hippodromesManager.get(update.id);\r\n        if (update.updatedPosition) {\r\n          hippodrome.moveTempMovingPoint(update.updatedPosition);\r\n          this.renderEditLabels(hippodrome, update);\r\n        }\r\n        break;\r\n      }\r\n      case EditActions.ADD_POINT: {\r\n        const hippodrome = this.hippodromesManager.get(update.id);\r\n        if (update.updatedPosition) {\r\n          hippodrome.addPoint(update.updatedPosition);\r\n          this.renderEditLabels(hippodrome, update);\r\n        }\r\n        break;\r\n      }\r\n      case EditActions.DISPOSE: {\r\n        const hippodrome = this.hippodromesManager.get(update.id);\r\n        hippodrome.dispose();\r\n        this.removeEditLabels(hippodrome);\r\n        break;\r\n      }\r\n      case EditActions.SET_EDIT_LABELS_RENDER_CALLBACK: {\r\n        const hippodrome = this.hippodromesManager.get(update.id);\r\n        this.editLabelsRenderFn = update.labelsRenderFn;\r\n        this.renderEditLabels(hippodrome, update);\r\n        break;\r\n      }\r\n      case EditActions.UPDATE_EDIT_LABELS: {\r\n        const hippodrome = this.hippodromesManager.get(update.id);\r\n        this.renderEditLabels(hippodrome, update, update.updateLabels);\r\n        break;\r\n      }\r\n      case EditActions.SET_MANUALLY: {\r\n        const hippodrome = this.hippodromesManager.get(update.id);\r\n        this.renderEditLabels(hippodrome, update, update.updateLabels);\r\n        break;\r\n      }\r\n      default: {\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n  handleEditUpdates(update: HippodromeEditUpdate) {\r\n    switch (update.editAction) {\r\n      case EditActions.INIT: {\r\n        this.hippodromesManager.createEditableHippodrome(\r\n          update.id,\r\n          this.editPointsLayer,\r\n          this.editHippodromesLayer,\r\n          this.coordinateConverter,\r\n          update.hippodromeOptions,\r\n          update.positions\r\n        );\r\n        break;\r\n      }\r\n      case EditActions.DRAG_POINT: {\r\n        const hippodrome = this.hippodromesManager.get(update.id);\r\n        if (hippodrome && hippodrome.enableEdit) {\r\n          hippodrome.movePoint(update.updatedPosition, update.updatedPoint);\r\n          this.renderEditLabels(hippodrome, update);\r\n        }\r\n        break;\r\n      }\r\n      case EditActions.DRAG_POINT_FINISH: {\r\n        const hippodrome = this.hippodromesManager.get(update.id);\r\n        if (hippodrome && hippodrome.enableEdit) {\r\n          hippodrome.endMovePoint();\r\n          this.renderEditLabels(hippodrome, update);\r\n        }\r\n        break;\r\n      }\r\n      case EditActions.DISABLE: {\r\n        const hippodrome = this.hippodromesManager.get(update.id);\r\n        if (hippodrome) {\r\n          hippodrome.enableEdit = false;\r\n          this.renderEditLabels(hippodrome, update);\r\n        }\r\n        break;\r\n      }\r\n      case EditActions.ENABLE: {\r\n        const hippodrome = this.hippodromesManager.get(update.id);\r\n        if (hippodrome) {\r\n          hippodrome.enableEdit = true;\r\n          this.renderEditLabels(hippodrome, update);\r\n        }\r\n        break;\r\n      }\r\n      case EditActions.DRAG_SHAPE: {\r\n        const hippodrome = this.hippodromesManager.get(update.id);\r\n        if (hippodrome && hippodrome.enableEdit) {\r\n          hippodrome.moveShape(update.draggedPosition, update.updatedPosition);\r\n        }\r\n        break;\r\n      }\r\n\r\n      case EditActions.DRAG_SHAPE_FINISH: {\r\n        const hippodrome = this.hippodromesManager.get(update.id);\r\n        if (hippodrome && hippodrome.enableEdit) {\r\n          hippodrome.endMoveShape();\r\n          this.renderEditLabels(hippodrome, update);\r\n        }\r\n        break;\r\n      }\r\n      default: {\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.hippodromesManager.clear();\r\n  }\r\n\r\n  getPointSize(point: EditPoint) {\r\n    return point.isVirtualEditPoint() ? point.props.virtualPointPixelSize : point.props.pixelSize;\r\n  }\r\n\r\n  getPointShow(point: EditPoint) {\r\n    return point.show && (point.isVirtualEditPoint() ? point.props.showVirtual : point.props.show);\r\n  }\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\r\n  selector: 'hippodrome-editor',\r\n  templateUrl: './hippodrome-editor.component.html',\r\n  providers: [CoordinateConverter, HippodromeManagerService]\r\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: HippodromeEditorService, },\n{type: CoordinateConverter, },\n{type: MapEventsManagerService, },\n{type: CameraService, },\n{type: HippodromeManagerService, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'editPointsLayer': [{ type: ViewChild, args: ['editPointsLayer', ] },],\n'editHippodromesLayer': [{ type: ViewChild, args: ['editHippodromesLayer', ] },],\n};\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}