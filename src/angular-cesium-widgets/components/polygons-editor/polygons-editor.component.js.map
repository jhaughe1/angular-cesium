{"version":3,"sources":["polygons-editor.component.ts"],"names":[],"mappings":"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","file":"polygons-editor.component.js","sourceRoot":"","sourcesContent":["import { Component, OnDestroy, ViewChild } from '@angular/core';\r\nimport { EditModes } from '../../models/edit-mode.enum';\r\nimport { PolygonEditUpdate } from '../../models/polygon-edit-update';\r\nimport { AcNotification } from '../../../angular-cesium/models/ac-notification';\r\nimport { EditActions } from '../../models/edit-actions.enum';\r\nimport { AcLayerComponent } from '../../../angular-cesium/components/ac-layer/ac-layer.component';\r\nimport { CoordinateConverter } from '../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\r\nimport { MapEventsManagerService } from '../../../angular-cesium/services/map-events-mananger/map-events-manager';\r\nimport { Subject } from 'rxjs/Subject';\r\nimport { CameraService } from '../../../angular-cesium/services/camera/camera.service';\r\nimport { EditPoint } from '../../models/edit-point';\r\nimport { PolygonsManagerService } from '../../services/entity-editors/polygons-editor/polygons-manager.service';\r\nimport { PolygonsEditorService } from '../../services/entity-editors/polygons-editor/polygons-editor.service';\r\nimport { LabelProps } from '../../models/label-props';\r\nimport { EditablePolygon } from '../../models/editable-polygon';\r\n\r\n\r\nexport class PolygonsEditorComponent implements OnDestroy {\r\n\r\n  private editLabelsRenderFn: (update: PolygonEditUpdate, labels: LabelProps[]) => LabelProps[];\r\n  public Cesium = Cesium;\r\n  public editPoints$ = new Subject<AcNotification>();\r\n  public editPolylines$ = new Subject<AcNotification>();\r\n  public editPolygons$ = new Subject<AcNotification>();\r\n\r\n  public appearance = new Cesium.PerInstanceColorAppearance({ flat: true });\r\n  public attributes = { color: Cesium.ColorGeometryInstanceAttribute.fromColor(new Cesium.Color(0.2, 0.2, 0.5, 0.5)) };\r\n  public polygonColor = new Cesium.Color(0.1, 0.5, 0.2, 0.4);\r\n  public lineColor = new Cesium.Color(0, 0, 0, 0.6);\r\n\r\n   private editPolygonsLayer: AcLayerComponent;\r\n   private editPointsLayer: AcLayerComponent;\r\n   private editPolylinesLayer: AcLayerComponent;\r\n\r\n  constructor(private polygonsEditor: PolygonsEditorService,\r\n              private coordinateConverter: CoordinateConverter,\r\n              private mapEventsManager: MapEventsManagerService,\r\n              private cameraService: CameraService,\r\n              private polygonsManager: PolygonsManagerService) {\r\n    this.polygonsEditor.init(this.mapEventsManager, this.coordinateConverter, this.cameraService, polygonsManager);\r\n    this.startListeningToEditorUpdates();\r\n  }\r\n\r\n  private startListeningToEditorUpdates() {\r\n    this.polygonsEditor.onUpdate().subscribe((update: PolygonEditUpdate) => {\r\n      if (update.editMode === EditModes.CREATE || update.editMode === EditModes.CREATE_OR_EDIT) {\r\n        this.handleCreateUpdates(update);\r\n      }\r\n      else if (update.editMode === EditModes.EDIT) {\r\n        this.handleEditUpdates(update);\r\n      }\r\n    });\r\n  }\r\n\r\n  getLabelId(element: any, index: number): string {\r\n    return index.toString();\r\n  }\r\n\r\n  renderEditLabels(polygon: EditablePolygon, update: PolygonEditUpdate, labels?: LabelProps[]) {\r\n    update.positions = polygon.getRealPositions();\r\n    update.points = polygon.getRealPoints();\r\n\r\n    if (labels) {\r\n      polygon.labels = labels;\r\n      this.editPolygonsLayer.update(polygon, polygon.getId());\r\n      return;\r\n    }\r\n\r\n    if (!this.editLabelsRenderFn) {\r\n      return;\r\n    }\r\n\r\n    polygon.labels = this.editLabelsRenderFn(update, polygon.labels);\r\n    this.editPolygonsLayer.update(polygon, polygon.getId());\r\n\r\n  }\r\n\r\n  removeEditLabels(polygon: EditablePolygon) {\r\n    polygon.labels = [];\r\n    this.editPolygonsLayer.update(polygon, polygon.getId());\r\n  }\r\n\r\n  handleCreateUpdates(update: PolygonEditUpdate) {\r\n    switch (update.editAction) {\r\n      case EditActions.INIT: {\r\n        this.polygonsManager.createEditablePolygon(\r\n          update.id,\r\n          this.editPolygonsLayer,\r\n          this.editPointsLayer,\r\n          this.editPolylinesLayer,\r\n          this.coordinateConverter,\r\n          update.polygonOptions\r\n        );\r\n        break;\r\n      }\r\n      case EditActions.MOUSE_MOVE: {\r\n        const polygon = this.polygonsManager.get(update.id);\r\n        if (update.updatedPosition) {\r\n          polygon.moveTempMovingPoint(update.updatedPosition);\r\n          this.renderEditLabels(polygon, update);\r\n        }\r\n        break;\r\n      }\r\n      case EditActions.ADD_POINT: {\r\n        const polygon = this.polygonsManager.get(update.id);\r\n        if (update.updatedPosition) {\r\n          polygon.addPoint(update.updatedPosition);\r\n          this.renderEditLabels(polygon, update);\r\n        }\r\n        break;\r\n      }\r\n      case EditActions.ADD_LAST_POINT: {\r\n        const polygon = this.polygonsManager.get(update.id);\r\n        if (update.updatedPosition) {\r\n          polygon.addLastPoint(update.updatedPosition);\r\n          this.renderEditLabels(polygon, update);\r\n        }\r\n        break;\r\n      }\r\n      case EditActions.DISPOSE: {\r\n        const polygon = this.polygonsManager.get(update.id);\r\n        polygon.dispose();\r\n        this.removeEditLabels(polygon);\r\n        this.editLabelsRenderFn = undefined;\r\n        break;\r\n      }\r\n      case EditActions.SET_EDIT_LABELS_RENDER_CALLBACK: {\r\n        const polygon = this.polygonsManager.get(update.id);\r\n        this.editLabelsRenderFn = update.labelsRenderFn;\r\n        this.renderEditLabels(polygon, update);\r\n        break;\r\n      }\r\n      case EditActions.UPDATE_EDIT_LABELS: {\r\n        const polygon = this.polygonsManager.get(update.id);\r\n        this.renderEditLabels(polygon, update, update.updateLabels);\r\n        break;\r\n      }\r\n      case EditActions.SET_MANUALLY: {\r\n        const polygon = this.polygonsManager.get(update.id);\r\n        this.renderEditLabels(polygon, update, update.updateLabels);\r\n        break;\r\n      }\r\n      default: {\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n  handleEditUpdates(update: PolygonEditUpdate) {\r\n    switch (update.editAction) {\r\n      case EditActions.INIT: {\r\n        this.polygonsManager.createEditablePolygon(\r\n          update.id,\r\n          this.editPolygonsLayer,\r\n          this.editPointsLayer,\r\n          this.editPolylinesLayer,\r\n          this.coordinateConverter,\r\n          update.polygonOptions,\r\n          update.positions\r\n        );\r\n        break;\r\n      }\r\n      case EditActions.DRAG_POINT: {\r\n        const polygon = this.polygonsManager.get(update.id);\r\n        if (polygon && polygon.enableEdit) {\r\n          polygon.movePoint(update.updatedPosition, update.updatedPoint);\r\n          this.renderEditLabels(polygon, update);\r\n        }\r\n        break;\r\n      }\r\n      case EditActions.DRAG_POINT_FINISH: {\r\n        const polygon = this.polygonsManager.get(update.id);\r\n        if (polygon && polygon.enableEdit && update.updatedPoint.isVirtualEditPoint()) {\r\n          polygon.changeVirtualPointToRealPoint(update.updatedPoint);\r\n          this.renderEditLabels(polygon, update);\r\n        }\r\n        break;\r\n      }\r\n      case EditActions.REMOVE_POINT: {\r\n        const polygon = this.polygonsManager.get(update.id);\r\n        if (polygon && polygon.enableEdit) {\r\n          polygon.removePoint(update.updatedPoint);\r\n          this.renderEditLabels(polygon, update);\r\n        }\r\n        break;\r\n      }\r\n      case EditActions.DISABLE: {\r\n        const polygon = this.polygonsManager.get(update.id);\r\n        if (polygon) {\r\n          polygon.enableEdit = false;\r\n          this.renderEditLabels(polygon, update);\r\n        }\r\n        break;\r\n      }\r\n      case EditActions.DRAG_SHAPE: {\r\n        const polygon = this.polygonsManager.get(update.id);\r\n        if (polygon && polygon.enableEdit) {\r\n          polygon.movePolygon(update.draggedPosition, update.updatedPosition);\r\n        }\r\n        break;\r\n      }\r\n\r\n      case EditActions.DRAG_SHAPE_FINISH: {\r\n        const polygon = this.polygonsManager.get(update.id);\r\n        if (polygon && polygon.enableEdit) {\r\n          polygon.endMovePolygon();\r\n          this.renderEditLabels(polygon, update);\r\n        }\r\n        break;\r\n      }\r\n      case EditActions.ENABLE: {\r\n        const polygon = this.polygonsManager.get(update.id);\r\n        if (polygon) {\r\n          polygon.enableEdit = true;\r\n          this.renderEditLabels(polygon, update);\r\n        }\r\n        break;\r\n      }\r\n      default: {\r\n        return;\r\n      }\r\n    }\r\n  }\r\n\r\n  ngOnDestroy(): void {\r\n    this.polygonsManager.clear();\r\n  }\r\n\r\n  getPointSize(point: EditPoint) {\r\n    return point.isVirtualEditPoint() ? point.props.virtualPointPixelSize : point.props.pixelSize;\r\n  }\r\n\r\n  getPointShow(point: EditPoint) {\r\n    return point.show && (point.isVirtualEditPoint() ? point.props.showVirtual : point.props.show);\r\n  }\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: Component, args: [{\r\n  selector: 'polygons-editor',\r\n  templateUrl: './polygons-editor.component.html',\r\n  providers: [CoordinateConverter, PolygonsManagerService]\r\n}, ] },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n{type: PolygonsEditorService, },\n{type: CoordinateConverter, },\n{type: MapEventsManagerService, },\n{type: CameraService, },\n{type: PolygonsManagerService, },\n];\nstatic propDecorators: {[key: string]: DecoratorInvocation[]} = {\n'editPolygonsLayer': [{ type: ViewChild, args: ['editPolygonsLayer', ] },],\n'editPointsLayer': [{ type: ViewChild, args: ['editPointsLayer', ] },],\n'editPolylinesLayer': [{ type: ViewChild, args: ['editPolylinesLayer', ] },],\n};\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}