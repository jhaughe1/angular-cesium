{"version":3,"sources":["polylines-editor.service.ts"],"names":[],"mappings":"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","file":"polylines-editor.service.js","sourceRoot":"","sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { MapEventsManagerService } from '../../../../angular-cesium/services/map-events-mananger/map-events-manager';\r\nimport { Subject } from 'rxjs/Subject';\r\nimport { Observable } from 'rxjs/Observable';\r\nimport { CesiumEvent } from '../../../../angular-cesium/services/map-events-mananger/consts/cesium-event.enum';\r\nimport { PickOptions } from '../../../../angular-cesium/services/map-events-mananger/consts/pickOptions.enum';\r\nimport { EditModes } from '../../../models/edit-mode.enum';\r\nimport { EditActions } from '../../../models/edit-actions.enum';\r\nimport { DisposableObservable } from '../../../../angular-cesium/services/map-events-mananger/disposable-observable';\r\nimport { CoordinateConverter } from '../../../../angular-cesium/services/coordinate-converter/coordinate-converter.service';\r\nimport { EditPoint } from '../../../models/edit-point';\r\nimport { CameraService } from '../../../../angular-cesium/services/camera/camera.service';\r\nimport { Cartesian3 } from '../../../../angular-cesium/models/cartesian3';\r\nimport { BehaviorSubject } from 'rxjs/BehaviorSubject';\r\nimport { PolylinesManagerService } from './polylines-manager.service';\r\nimport { PointProps, PolylineEditOptions, PolylineProps } from '../../../models/polyline-edit-options';\r\nimport { PolylineEditUpdate } from '../../../models/polyline-edit-update';\r\nimport { PolylineEditorObservable } from '../../../models/polyline-editor-observable';\r\nimport { EditPolyline } from '../../../models';\r\nimport { LabelProps } from '../../../models/label-props';\r\n\r\nexport const DEFAULT_POLYLINE_OPTIONS: PolylineEditOptions = {\r\n  addPointEvent: CesiumEvent.LEFT_CLICK,\r\n  addLastPointEvent: CesiumEvent.LEFT_DOUBLE_CLICK,\r\n  removePointEvent: CesiumEvent.RIGHT_CLICK,\r\n  dragPointEvent: CesiumEvent.LEFT_CLICK_DRAG,\r\n  dragShapeEvent: CesiumEvent.LEFT_CLICK_DRAG,\r\n  allowDrag: true,\r\n  pointProps: {\r\n    color: Cesium.Color.WHITE,\r\n    outlineColor: Cesium.Color.BLACK,\r\n    outlineWidth: 1,\r\n    pixelSize: 15,\r\n    virtualPointPixelSize: 8,\r\n    show: true,\r\n    showVirtual: true,\r\n  },\r\n  polylineProps: {\r\n    material: () => Cesium.Color.BLACK,\r\n    width: 3,\r\n  },\r\n};\r\n\r\n/**\r\n * Service for creating editable polylines\r\n *\r\n *  * You must provide `PolylineEditorService` yourself.\r\n * PolygonsEditorService works together with `<polylines-editor>` component. Therefor you need to create `<polylines-editor>`\r\n * for each `PolylineEditorService`, And of course somewhere under `<ac-map>`/\r\n *\r\n * + `create` for starting a creation of the shape over the map. Returns a extension of `PolylineEditorObservable`.\r\n * + `edit` for editing shape over the map starting from a given positions. Returns an extension of `PolylineEditorObservable`.\r\n * + To stop editing call `dsipose()` from the `PolylineEditorObservable` you get back from `create()` \\ `edit()`.\r\n *\r\n * **Labels over editted shapes**\r\n * Angular Cesium allows you to draw labels over a shape that is being edited with one of the editors.\r\n * To add label drawing logic to your editor use the function `setLabelsRenderFn()` that is defined on the\r\n * `PolylineEditorObservable` that is returned from calling `create()` \\ `edit()` of one of the editor services.\r\n * `setLabelsRenderFn()` - receives a callback that is called every time the shape is redrawn\r\n * (except when the shape is being dragged). The callback is called with the last shape state and with an array of the current labels.\r\n * The callback should return type `LabelProps[]`.\r\n * You can also use `updateLabels()` to pass an array of labels of type `LabelProps[]` to be drawn.\r\n *\r\n * usage:\r\n * ```typescript\r\n *  // Start creating polyline\r\n *  const editing$ = polylinesEditorService.create();\r\n *  this.editing$.subscribe(editResult => {\r\n *\t\t\t\tconsole.log(editResult.positions);\r\n *\t\t});\r\n *\r\n *  // Or edit polyline from existing polyline cartesian3 positions\r\n *  const editing$ = this.polylinesEditor.edit(initialPos);\r\n *\r\n * ```\r\n */\r\n\r\nexport class PolylinesEditorService {\r\n  private mapEventsManager: MapEventsManagerService;\r\n  private updateSubject = new Subject<PolylineEditUpdate>();\r\n  private updatePublisher = this.updateSubject.publish(); // TODO maybe not needed\r\n  private counter = 0;\r\n  private coordinateConverter: CoordinateConverter;\r\n  private cameraService: CameraService;\r\n  private polylinesManager: PolylinesManagerService;\r\n  private observablesMap = new Map<string, DisposableObservable<any>[]>();\r\n\r\n  init(mapEventsManager: MapEventsManagerService,\r\n       coordinateConverter: CoordinateConverter,\r\n       cameraService: CameraService,\r\n       polylinesManager: PolylinesManagerService) {\r\n    this.mapEventsManager = mapEventsManager;\r\n    this.updatePublisher.connect();\r\n    this.coordinateConverter = coordinateConverter;\r\n    this.cameraService = cameraService;\r\n    this.polylinesManager = polylinesManager;\r\n  }\r\n\r\n  onUpdate(): Observable<PolylineEditUpdate> {\r\n    return this.updatePublisher;\r\n  }\r\n\r\n  create(options = DEFAULT_POLYLINE_OPTIONS, eventPriority = 100): PolylineEditorObservable {\r\n    const positions: Cartesian3[] = [];\r\n    const id = this.generteId();\r\n    const polylineOptions = this.setOptions(options);\r\n\r\n    const clientEditSubject = new BehaviorSubject<PolylineEditUpdate>({\r\n      id,\r\n      editAction: null,\r\n      editMode: EditModes.CREATE\r\n    });\r\n    let finishedCreate = false;\r\n\r\n    this.updateSubject.next({\r\n      id,\r\n      positions,\r\n      editMode: EditModes.CREATE,\r\n      editAction: EditActions.INIT,\r\n      polylineOptions: polylineOptions,\r\n    });\r\n\r\n    const mouseMoveRegistration = this.mapEventsManager.register({\r\n      event: CesiumEvent.MOUSE_MOVE,\r\n      pick: PickOptions.NO_PICK,\r\n      priority: eventPriority,\r\n    });\r\n    const addPointRegistration = this.mapEventsManager.register({\r\n      event: polylineOptions.addPointEvent,\r\n      pick: PickOptions.NO_PICK,\r\n      priority: eventPriority,\r\n    });\r\n    const addLastPointRegistration = this.mapEventsManager.register({\r\n      event: polylineOptions.addLastPointEvent,\r\n      pick: PickOptions.NO_PICK,\r\n      priority: eventPriority,\r\n    });\r\n\r\n    this.observablesMap.set(id, [mouseMoveRegistration, addPointRegistration, addLastPointRegistration]);\r\n    const editorObservable = this.createEditorObservable(clientEditSubject, id);\r\n\r\n    mouseMoveRegistration.subscribe(({ movement: { endPosition } }) => {\r\n      const position = this.coordinateConverter.screenToCartesian3(endPosition);\r\n      if (position) {\r\n        this.updateSubject.next({\r\n          id,\r\n          positions: this.getPositions(id),\r\n          editMode: EditModes.CREATE,\r\n          updatedPosition: position,\r\n          editAction: EditActions.MOUSE_MOVE,\r\n        });\r\n      }\r\n    });\r\n\r\n    addPointRegistration.subscribe(({ movement: { endPosition } }) => {\r\n      if (finishedCreate) {\r\n        return;\r\n      }\r\n      const position = this.coordinateConverter.screenToCartesian3(endPosition);\r\n      if (!position) {\r\n        return;\r\n      }\r\n      const allPositions = this.getPositions(id);\r\n      if (allPositions.find((cartesian) => cartesian.equals(position))) {\r\n        return;\r\n      }\r\n      const updateValue = {\r\n        id,\r\n        positions: allPositions,\r\n        editMode: EditModes.CREATE,\r\n        updatedPosition: position,\r\n        editAction: EditActions.ADD_POINT,\r\n      };\r\n      this.updateSubject.next(updateValue);\r\n      clientEditSubject.next({\r\n        ...updateValue,\r\n        positions: this.getPositions(id),\r\n        points: this.getPoints(id),\r\n      });\r\n      if (polylineOptions.maximumNumberOfPoints && allPositions.length + 1 === polylineOptions.maximumNumberOfPoints) {\r\n        const update = {\r\n          id,\r\n          positions: this.getPositions(id),\r\n          editMode: EditModes.CREATE,\r\n          updatedPosition: position,\r\n          editAction: EditActions.ADD_LAST_POINT,\r\n        };\r\n        this.updateSubject.next(update);\r\n        clientEditSubject.next({\r\n          ...update,\r\n          positions: this.getPositions(id),\r\n          points: this.getPoints(id),\r\n        });\r\n\r\n        const changeMode = {\r\n          id,\r\n          editMode: EditModes.CREATE,\r\n          editAction: EditActions.CHANGE_TO_EDIT,\r\n        };\r\n        this.updateSubject.next(changeMode);\r\n        clientEditSubject.next(changeMode);\r\n        if (this.observablesMap.has(id)) {\r\n          this.observablesMap.get(id).forEach(registration => registration.dispose());\r\n        }\r\n        this.observablesMap.delete(id);\r\n        this.editPolyline(id, positions, eventPriority, clientEditSubject, polylineOptions, editorObservable);\r\n        finishedCreate = true;\r\n      }\r\n    });\r\n\r\n    addLastPointRegistration.subscribe(({ movement: { endPosition } }) => {\r\n      const position = this.coordinateConverter.screenToCartesian3(endPosition);\r\n      if (!position) {\r\n        return;\r\n      }\r\n      // position already added by addPointRegistration\r\n      const updateValue = {\r\n        id,\r\n        positions: this.getPositions(id),\r\n        editMode: EditModes.CREATE,\r\n        updatedPosition: position,\r\n        editAction: EditActions.ADD_LAST_POINT,\r\n      };\r\n      this.updateSubject.next(updateValue);\r\n      clientEditSubject.next({\r\n        ...updateValue,\r\n        positions: this.getPositions(id),\r\n        points: this.getPoints(id),\r\n      });\r\n\r\n      const changeMode = {\r\n        id,\r\n        editMode: EditModes.CREATE,\r\n        editAction: EditActions.CHANGE_TO_EDIT,\r\n      };\r\n      this.updateSubject.next(changeMode);\r\n      clientEditSubject.next(changeMode);\r\n      if (this.observablesMap.has(id)) {\r\n        this.observablesMap.get(id).forEach(registration => registration.dispose());\r\n      }\r\n      this.observablesMap.delete(id);\r\n      this.editPolyline(id, positions, eventPriority, clientEditSubject, polylineOptions, editorObservable);\r\n      finishedCreate = true;\r\n    });\r\n\r\n    return editorObservable;\r\n  }\r\n\r\n  edit(positions: Cartesian3[], options = DEFAULT_POLYLINE_OPTIONS, priority = 100): PolylineEditorObservable {\r\n    if (positions.length < 2) {\r\n      throw new Error('Polylines editor error edit(): polyline should have at least 2 positions');\r\n    }\r\n    const id = this.generteId();\r\n    const polylineOptions = this.setOptions(options);\r\n    const editSubject = new BehaviorSubject<PolylineEditUpdate>({\r\n      id,\r\n      editAction: null,\r\n      editMode: EditModes.EDIT\r\n    });\r\n    const update = {\r\n      id,\r\n      positions: positions,\r\n      editMode: EditModes.EDIT,\r\n      editAction: EditActions.INIT,\r\n      polylineOptions: polylineOptions,\r\n    };\r\n    this.updateSubject.next(update);\r\n    editSubject.next({\r\n      ...update,\r\n      positions: this.getPositions(id),\r\n      points: this.getPoints(id),\r\n    });\r\n    return this.editPolyline(\r\n      id,\r\n      positions,\r\n      priority,\r\n      editSubject,\r\n      polylineOptions\r\n    )\r\n  }\r\n\r\n  private editPolyline(id: string,\r\n                       positions: Cartesian3[],\r\n                       priority: number,\r\n                       editSubject: Subject<PolylineEditUpdate>,\r\n                       options: PolylineEditOptions,\r\n                       editObservable?: PolylineEditorObservable) {\r\n\r\n    const pointDragRegistration = this.mapEventsManager.register({\r\n      event: options.dragPointEvent,\r\n      entityType: EditPoint,\r\n      pick: PickOptions.PICK_FIRST,\r\n      priority,\r\n    });\r\n\r\n    const pointRemoveRegistration = this.mapEventsManager.register({\r\n      event: options.removePointEvent,\r\n      entityType: EditPoint,\r\n      pick: PickOptions.PICK_FIRST,\r\n      priority,\r\n    });\r\n\r\n\r\n    let shapeDragRegistration;\r\n    if (options.allowDrag) {\r\n      shapeDragRegistration = this.mapEventsManager.register({\r\n        event: options.dragShapeEvent,\r\n        entityType: EditPolyline,\r\n        pick: PickOptions.PICK_FIRST,\r\n        priority,\r\n      });\r\n    }\r\n\r\n    if (shapeDragRegistration) {\r\n      shapeDragRegistration\r\n        .do(x => console.log(x))\r\n        .do(({ movement: { drop } }) => this.cameraService.enableInputs(drop))\r\n        .subscribe(({ movement: { startPosition, endPosition, drop }, entities }) => {\r\n          const endDragPosition = this.coordinateConverter.screenToCartesian3(endPosition);\r\n          const startDragPosition = this.coordinateConverter.screenToCartesian3(startPosition);\r\n          if (!endDragPosition) {\r\n            return;\r\n          }\r\n\r\n          const update = {\r\n            id,\r\n            positions: this.getPositions(id),\r\n            editMode: EditModes.EDIT,\r\n            updatedPosition: endDragPosition,\r\n            draggedPosition: startDragPosition,\r\n            editAction: drop ? EditActions.DRAG_SHAPE_FINISH : EditActions.DRAG_SHAPE,\r\n          };\r\n          this.updateSubject.next(update);\r\n          editSubject.next({\r\n            ...update,\r\n            positions: this.getPositions(id),\r\n            points: this.getPoints(id),\r\n          });\r\n        });\r\n    }\r\n\r\n    pointDragRegistration\r\n      .do(({ movement: { drop } }) => this.cameraService.enableInputs(drop))\r\n      .subscribe(({ movement: { endPosition, drop }, entities }) => {\r\n        const position = this.coordinateConverter.screenToCartesian3(endPosition);\r\n        if (!position) {\r\n          return;\r\n        }\r\n        const point: EditPoint = entities[0];\r\n\r\n        const update = {\r\n          id,\r\n          positions: this.getPositions(id),\r\n          editMode: EditModes.EDIT,\r\n          updatedPosition: position,\r\n          updatedPoint: point,\r\n          editAction: drop ? EditActions.DRAG_POINT_FINISH : EditActions.DRAG_POINT,\r\n        };\r\n        this.updateSubject.next(update);\r\n        editSubject.next({\r\n          ...update,\r\n          positions: this.getPositions(id),\r\n          points: this.getPoints(id),\r\n        });\r\n      });\r\n\r\n    pointRemoveRegistration.subscribe(({ entities }) => {\r\n      const point: EditPoint = entities[0];\r\n      const allPositions = [...this.getPositions(id)];\r\n      if (allPositions.length < 3) {\r\n        return;\r\n      }\r\n      const index = allPositions.findIndex(position => point.getPosition().equals(position as Cartesian3));\r\n      if (index < 0) {\r\n        return;\r\n      }\r\n\r\n      const update = {\r\n        id,\r\n        positions: allPositions,\r\n        editMode: EditModes.EDIT,\r\n        updatedPoint: point,\r\n        editAction: EditActions.REMOVE_POINT,\r\n      };\r\n      this.updateSubject.next(update);\r\n      editSubject.next({\r\n        ...update,\r\n        positions: this.getPositions(id),\r\n        points: this.getPoints(id),\r\n      });\r\n    });\r\n\r\n    const observables = [pointDragRegistration, pointRemoveRegistration];\r\n    if (shapeDragRegistration) {\r\n      observables.push(shapeDragRegistration);\r\n    }\r\n    this.observablesMap.set(id, observables);\r\n    return this.createEditorObservable(editSubject, id);\r\n  }\r\n\r\n  private setOptions(options: PolylineEditOptions) {\r\n    const defaultClone = JSON.parse(JSON.stringify(DEFAULT_POLYLINE_OPTIONS));\r\n    const polylineOptions = Object.assign(defaultClone, options);\r\n    polylineOptions.pointProps = Object.assign({}, DEFAULT_POLYLINE_OPTIONS.pointProps, options.pointProps);\r\n    polylineOptions.polylineProps = Object.assign({},\r\n      DEFAULT_POLYLINE_OPTIONS.polylineProps, options.polylineProps);\r\n    return polylineOptions;\r\n  }\r\n\r\n\r\n  private createEditorObservable(observableToExtend: any, id: string): PolylineEditorObservable {\r\n    observableToExtend.dispose = () => {\r\n      const observables = this.observablesMap.get(id);\r\n      if (observables) {\r\n        observables.forEach(obs => obs.dispose())\r\n      }\r\n      this.observablesMap.delete(id);\r\n      this.updateSubject.next({\r\n        id,\r\n        positions: this.getPositions(id),\r\n        editMode: EditModes.CREATE_OR_EDIT,\r\n        editAction: EditActions.DISPOSE,\r\n      });\r\n    };\r\n\r\n    observableToExtend.enable = () => {\r\n      this.updateSubject.next({\r\n        id,\r\n        positions: this.getPositions(id),\r\n        editMode: EditModes.EDIT,\r\n        editAction: EditActions.ENABLE,\r\n      });\r\n    };\r\n\r\n    observableToExtend.disable = () => {\r\n      this.updateSubject.next({\r\n        id,\r\n        positions: this.getPositions(id),\r\n        editMode: EditModes.EDIT,\r\n        editAction: EditActions.DISABLE,\r\n      });\r\n    };\r\n\r\n    observableToExtend.setManually = (points: {\r\n      position: Cartesian3,\r\n      pointProp?: PointProps\r\n    }[] | Cartesian3[], polylineProps?: PolylineProps) => {\r\n      const polyline = this.polylinesManager.get(id);\r\n      polyline.setManually(points, polylineProps);\r\n      this.updateSubject.next({\r\n        id,\r\n        editMode: EditModes.CREATE_OR_EDIT,\r\n        editAction: EditActions.SET_MANUALLY,\r\n      });\r\n    };\r\n\r\n    observableToExtend.setLabelsRenderFn = (callback: any) => {\r\n      this.updateSubject.next({\r\n        id,\r\n        editMode: EditModes.CREATE_OR_EDIT,\r\n        editAction: EditActions.SET_EDIT_LABELS_RENDER_CALLBACK,\r\n        labelsRenderFn: callback,\r\n      })\r\n    };\r\n\r\n    observableToExtend.updateLabels = (labels: LabelProps[]) => {\r\n      this.updateSubject.next({\r\n        id,\r\n        editMode: EditModes.CREATE_OR_EDIT,\r\n        editAction: EditActions.UPDATE_EDIT_LABELS,\r\n        updateLabels: labels,\r\n      })\r\n    };\r\n    observableToExtend.getCurrentPoints = () => this.getPoints(id);\r\n\r\n    observableToExtend.getEditValue = () => observableToExtend.getValue();\r\n\r\n    observableToExtend.getLabels = (): LabelProps[] => this.polylinesManager.get(id).labels;\r\n\r\n    return observableToExtend as PolylineEditorObservable;\r\n  }\r\n\r\n  private generteId(): string {\r\n    return 'edit-polyline-' + this.counter++;\r\n  }\r\n\r\n  private getPositions(id: string) {\r\n    const polyline = this.polylinesManager.get(id);\r\n    return polyline.getRealPositions()\r\n  }\r\n\r\n  private getPoints(id: string) {\r\n    const polyline = this.polylinesManager.get(id);\r\n    return polyline.getRealPoints();\r\n  }\r\nstatic decorators: DecoratorInvocation[] = [\n{ type: Injectable },\n];\n/** @nocollapse */\nstatic ctorParameters: () => ({type: any, decorators?: DecoratorInvocation[]}|null)[] = () => [\n];\n}\r\n\ninterface DecoratorInvocation {\n  type: Function;\n  args?: any[];\n}\n"]}